<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="findSVI">
<title>SVI in Local Context • findSVI</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SVI in Local Context">
<meta property="og:description" content="findSVI">
<meta property="og:image" content="https://heli-xu.github.io/findSVI/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">findSVI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/findSVI.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/SVI-mapping.html">Mapping SVI for spatial analysis</a>
    <a class="dropdown-item" href="../articles/svi-covid.html">Connecting SVI and health outcome</a>
    <a class="dropdown-item" href="../articles/tract-level_SVI_in_Philly.html">SVI in Local Context</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/heli-xu/findSVI/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>SVI in Local Context</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/heli-xu/findSVI/blob/HEAD/vignettes/tract-level_SVI_in_Philly.Rmd" class="external-link"><code>vignettes/tract-level_SVI_in_Philly.Rmd</code></a></small>
      <div class="d-none name"><code>tract-level_SVI_in_Philly.Rmd</code></div>
    </div>

    
    
<p>Since SVI uses percentile ranks to summarize 16 census variables
representing socioeconomic and demographic factors, it’s important to
keep in mind the result may be affected by what we are ranking each
geographic unit against.</p>
<p>For example, if we are interested in SVI for Philadelphia (County),
PA at the census tract level for 2020, we could download the tract-level
SVI result for PA from <a href="https://www.atsdr.cdc.gov/placeandhealth/svi/data_documentation_download.html" class="external-link">CDC/ATSDR
SVI database</a>, which is ranking each tract against all tracts in PA.
Alternatively, we could use findSVI to calculate tract-level SVI for
Philadelphia county in PA for 2020, which is ranking each tract against
all tracts in Philadelphia. Here, we’ll compare what they would look
like for both approaches, and discuss the potential implications.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heli-xu/findSVI" class="external-link">findSVI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="svi-ranked-within-all-pa-cdc-and-findsvi-strongly-correlate">SVI ranked within all PA: CDC and findSVI strongly correlate<a class="anchor" aria-label="anchor" href="#svi-ranked-within-all-pa-cdc-and-findsvi-strongly-correlate"></a>
</h2>
<p>On the CDC/ATSDR SVI database, SVI results are available in the
format of shapefile and data table (.csv). After downloading and
importing the data for the whole Pennsylvania into R (using the <a href="https://r-spatial.github.io/sf/index.html%20for%20shapefile" class="external-link">sf
package</a> for shapefile), we’ll filter by the county and only keep the
data for Philadelphia (which happens to be the city itself).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#source: https://www.atsdr.cdc.gov/placeandhealth/svi/data_documentation_download.html</span></span>
<span></span>
<span><span class="co">#For shapefile</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/unzip.html" class="external-link">unzip</a></span><span class="op">(</span><span class="st">"../../../Pennsylvania.zip"</span>,</span>
<span>  exdir <span class="op">=</span> <span class="st">"pa_ct_2020_shapefile"</span>, junkpaths <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdc_svi_pa_ct_2020</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"pa_ct_2020_shapefile/SVI2020_PENNSYLVANIA_tract.shp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#For csv</span></span>
<span><span class="va">cdc_svi_pa_ct_2020</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"../Pennsylvania.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cdc_svi_phl_2020</span> <span class="op">&lt;-</span> <span class="va">cdc_svi_pa_ct_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"RPL_THEME"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co">#CDC use -999 as NAs</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RPL_THEMES</span><span class="op">&gt;=</span> <span class="fl">0</span>,</span>
<span>    <span class="va">COUNTY</span> <span class="op">==</span> <span class="st">"Philadelphia"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">cdc_svi_phl_2020</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 388</span></span>
<span><span class="co">#&gt; Columns: 12</span></span>
<span><span class="co">#&gt; $ ST         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "42", "42", "42", "42", "42", "42", "42", "42", "42", "42",…</span></span>
<span><span class="co">#&gt; $ STATE      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Pennsylvania", "Pennsylvania", "Pennsylvania", "Pennsylvan…</span></span>
<span><span class="co">#&gt; $ ST_ABBR    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "PA", "PA", "PA", "PA", "PA", "PA", "PA", "PA", "PA", "PA",…</span></span>
<span><span class="co">#&gt; $ STCNTY     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "42101", "42101", "42101", "42101", "42101", "42101", "4210…</span></span>
<span><span class="co">#&gt; $ COUNTY     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Philadelphia", "Philadelphia", "Philadelphia", "Philadelph…</span></span>
<span><span class="co">#&gt; $ FIPS       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "42101000101", "42101000102", "42101000200", "42101000300",…</span></span>
<span><span class="co">#&gt; $ LOCATION   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Census Tract 1.01, Philadelphia County, Pennsylvania", "Ce…</span></span>
<span><span class="co">#&gt; $ RPL_THEME1 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3105, 0.2976, 0.7757, 0.1388, 0.4349, 0.0029, 0.0567, 0.8…</span></span>
<span><span class="co">#&gt; $ RPL_THEME2 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.2015, 0.0029, 0.0464, 0.2955, 0.2479, 0.0012, 0.0620, 0.1…</span></span>
<span><span class="co">#&gt; $ RPL_THEME3 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.7213, 0.5299, 0.9150, 0.8115, 0.8057, 0.6070, 0.5797, 0.8…</span></span>
<span><span class="co">#&gt; $ RPL_THEME4 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.5494, 0.9005, 0.9729, 0.9576, 0.9582, 0.3605, 0.6789, 0.9…</span></span>
<span><span class="co">#&gt; $ RPL_THEMES <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3802, 0.2253, 0.7677, 0.5244, 0.6817, 0.0059, 0.1658, 0.8…</span></span></code></pre></div>
<p>As a proof of concept, we’ll use findSVI to reproduce CDC/ATSDR’s
version of tract-level SVI using percentile ranks aganist all tracts in
PA, and select the tracts in Philadelphia County. Putting both versions
of SVI on a scatterplot, we can see they are highly consistent.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pa_ct_svi_2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_svi.html">find_svi</a></span><span class="op">(</span></span>
<span>  <span class="fl">2020</span>, </span>
<span>  state <span class="op">=</span> <span class="st">"PA"</span>, </span>
<span>  geography <span class="op">=</span> <span class="st">"tract"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">phl_ct_2020_svi_PA</span> <span class="op">&lt;-</span> <span class="va">pa_ct_svi_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">NAME</span>, <span class="st">"Philadelphia County"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phl_ct_svi_check</span> <span class="op">&lt;-</span> <span class="va">cdc_svi_phl_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    GEOID <span class="op">=</span> <span class="va">FIPS</span>,</span>
<span>    CDC_SVI <span class="op">=</span> <span class="va">RPL_THEMES</span>,</span>
<span>    CDC_SVI1 <span class="op">=</span> <span class="va">RPL_THEME1</span>,</span>
<span>    CDC_SVI2 <span class="op">=</span> <span class="va">RPL_THEME2</span>,</span>
<span>    CDC_SVI3 <span class="op">=</span> <span class="va">RPL_THEME3</span>,</span>
<span>    CDC_SVI4 <span class="op">=</span> <span class="va">RPL_THEME4</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">phl_ct_2020_svi_PA</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>findSVI_SVI <span class="op">=</span> <span class="va">RPL_themes</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"GEOID"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">phl_ct_svi_check</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CDC_SVI</span>, y <span class="op">=</span> <span class="va">findSVI_SVI</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">'orange'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Tract-level overall SVI in Philadelphia (2020)"</span>,</span>
<span>       subtitle<span class="op">=</span> <span class="st">"CDC/ATSDR vs. findSVI (ranking aganist tracts in PA)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"CDC"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"findSVI"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#4D4948"</span>, size <span class="op">=</span> <span class="fl">13</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="tract-level_SVI_in_Philly_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>With a little peace of mind, we will now look at how SVI is affected
if we use percentile ranks against just tracts in Philadelphia County
instead of all PA.</p>
</div>
<div class="section level2">
<h2 id="svi-ranked-within-philadelphia">SVI ranked within Philadelphia<a class="anchor" aria-label="anchor" href="#svi-ranked-within-philadelphia"></a>
</h2>
<p>To retrieve census data and calculate SVI for a specific county, we
need to use <code><a href="../reference/get_census_data.html">get_census_data()</a></code> and <code><a href="../reference/get_svi.html">get_svi()</a></code>
(as oppose to the one-step <code>find_svi</code> for state-level data
processing).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phl_ct_2020_data</span> <span class="op">&lt;-</span> <span class="fu">get_census_dataata</span><span class="op">(</span></span>
<span>  <span class="fl">2020</span>, </span>
<span>  state <span class="op">=</span> <span class="st">"PA"</span>,</span>
<span>  county <span class="op">=</span> <span class="st">"Philadelphia"</span>,</span>
<span>  geography <span class="op">=</span> <span class="st">"tract"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">phl_ct_svi_2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_svi.html">get_svi</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="va">phl_ct_2020_data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svi_clean</span> <span class="op">&lt;-</span> <span class="va">phl_ct_svi_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">GEOID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"RPL_theme"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">svi_clean</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 390</span></span>
<span><span class="co">#&gt; Columns: 6</span></span>
<span><span class="co">#&gt; $ GEOID      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "42101000101", "42101000102", "42101000200", "42101000300",…</span></span>
<span><span class="co">#&gt; $ RPL_theme1 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.1080, 0.1414, 0.4267, 0.0437, 0.2057, 0.0026, 0.0180, 0.5…</span></span>
<span><span class="co">#&gt; $ RPL_theme2 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.2128, 0.0103, 0.1333, 0.2282, 0.2641, 0.0026, 0.1179, 0.1…</span></span>
<span><span class="co">#&gt; $ RPL_theme3 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.1769, 0.0436, 0.5359, 0.3051, 0.2923, 0.0769, 0.0615, 0.4…</span></span>
<span><span class="co">#&gt; $ RPL_theme4 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3846, 0.7282, 0.9154, 0.9128, 0.9436, 0.3308, 0.8436, 0.9…</span></span>
<span><span class="co">#&gt; $ RPL_themes <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.1385, 0.0846, 0.4692, 0.2538, 0.3974, 0.0000, 0.1333, 0.5…</span></span></code></pre></div>
<p>If we plot out overall SVI using the two different ranking methods,
we can observe an interesting pattern, where they correlate well at both
ends of the SVI spectrum but correlate poorly in the middle.
Specifically, SVI using ranks against PA tracts (CDC) appears higher
than using SVI using ranks against tracts within Philadelphia
(findSVI).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">join_svi</span> <span class="op">&lt;-</span> <span class="va">cdc_svi_phl_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    GEOID <span class="op">=</span> <span class="va">FIPS</span>,</span>
<span>    CDC_SVI <span class="op">=</span> <span class="va">RPL_THEMES</span>,</span>
<span>    CDC_SVI1 <span class="op">=</span> <span class="va">RPL_THEME1</span>,</span>
<span>    CDC_SVI2 <span class="op">=</span> <span class="va">RPL_THEME2</span>,</span>
<span>    CDC_SVI3 <span class="op">=</span> <span class="va">RPL_THEME3</span>,</span>
<span>    CDC_SVI4 <span class="op">=</span> <span class="va">RPL_THEME4</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">svi_clean</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>findSVI_SVI <span class="op">=</span> <span class="va">RPL_themes</span><span class="op">)</span>, </span>
<span>      by <span class="op">=</span> <span class="st">"GEOID"</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="va">join_svi</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CDC_SVI</span>, y <span class="op">=</span> <span class="va">findSVI_SVI</span>, color <span class="op">=</span> <span class="va">findSVI_SVI</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"orange"</span>, high <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">'orange'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Tract-level overall SVI in Philadelphia (2020)"</span>,</span>
<span>       subtitle<span class="op">=</span> <span class="st">"Ranking aganist tracts in PA (CDC) vs. \nranking against tracts in Philadelphia (findSVI)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"CDC"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"findSVI"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Overall SVI"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span>, hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#4D4948"</span>, size <span class="op">=</span> <span class="fl">12</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="tract-level_SVI_in_Philly_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Quantitatively, the correlation coefficient between two versions of
SVI is 0.9055097, suggesting a discrepancy that perhaps warrants more
discussion.</p>
</div>
<div class="section level2">
<h2 id="svi-ranked-within-another-county">SVI ranked within another county<a class="anchor" aria-label="anchor" href="#svi-ranked-within-another-county"></a>
</h2>
<p>–Montgomery, for example.</p>
<p>Let’s follow the same steps as above:</p>
<ul>
<li><p>Select the tracts for Montgomery County from downloaded data
(ranking against tracts within PA).</p></li>
<li><p>Calculate SVI with findSVI for Montgomery County (ranking against
tracts within the county)</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mont_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_census_data.html">get_census_data</a></span><span class="op">(</span></span>
<span>  <span class="fl">2020</span>,</span>
<span>  state <span class="op">=</span> <span class="st">"PA"</span>,</span>
<span>  county <span class="op">=</span> <span class="st">"Montgomery"</span>,</span>
<span>  geography <span class="op">=</span> <span class="st">"tract"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mont_ct_svi_2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_svi.html">get_svi</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="va">mont_data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mont_svi</span> <span class="op">&lt;-</span> <span class="va">mont_ct_svi_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">GEOID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"RPL_theme"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cdc_svi_mont_2020</span> <span class="op">&lt;-</span> <span class="va">cdc_svi_pa_ct_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"RPL_THEME"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RPL_THEMES</span><span class="op">&gt;=</span> <span class="fl">0</span>,</span>
<span>    <span class="va">COUNTY</span> <span class="op">==</span> <span class="st">"Montgomery"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">join_svi2</span> <span class="op">&lt;-</span> <span class="va">cdc_svi_mont_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>    GEOID <span class="op">=</span> <span class="va">FIPS</span>,</span>
<span>    CDC_SVI <span class="op">=</span> <span class="va">RPL_THEMES</span>,</span>
<span>    CDC_SVI1 <span class="op">=</span> <span class="va">RPL_THEME1</span>,</span>
<span>    CDC_SVI2 <span class="op">=</span> <span class="va">RPL_THEME2</span>,</span>
<span>    CDC_SVI3 <span class="op">=</span> <span class="va">RPL_THEME3</span>,</span>
<span>    CDC_SVI4 <span class="op">=</span> <span class="va">RPL_THEME4</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">mont_svi</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>findSVI_SVI <span class="op">=</span> <span class="va">RPL_themes</span><span class="op">)</span>, </span>
<span>      by <span class="op">=</span> <span class="st">"GEOID"</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="va">join_svi2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CDC_SVI</span>, y <span class="op">=</span> <span class="va">findSVI_SVI</span>, color <span class="op">=</span> <span class="va">findSVI_SVI</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_color_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"orange"</span>, high <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">'orange'</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Tract-level overall SVI in Montgomery County (2020)"</span>,</span>
<span>       subtitle<span class="op">=</span> <span class="st">"Ranking aganist tracts in PA (CDC) vs. \nranking against tracts in Montgomery (findSVI)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"CDC"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"findSVI"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Overall SVI"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"#4D4948"</span>, size <span class="op">=</span> <span class="fl">12</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="tract-level_SVI_in_Philly_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>Mmm, there’s also a discrepancy particularly in the middle of the SVI
spectrum, but the curve is now “concave down”–SVI ranked against PA
tracts (CDC) is lower than SVI ranked against Montgomery tracts
(findSVI).</p>
</div>
<div class="section level2">
<h2 id="distribution-of-svi-variables">Distribution of SVI variables<a class="anchor" aria-label="anchor" href="#distribution-of-svi-variables"></a>
</h2>
<p>As mentioned before, SVI is a composite percentile rank of 16 census
variables. Percentile rank is a concept that represents the percentage
of values in a distribution that are equal to or below a specific value.
It is a way to express the relative standing or position of a particular
value within a distribution. <strong>Importantly, if a distribution
changes the percentile rank will change, even if the value being ranked
stays the same.</strong> This may be one of the explanations why we
observe the discrepancies in SVI using different ranking methods.</p>
<p>For example, the percentile rank of percentage of minority
(EP_MINRTY) of a tract in Philadelphia will differ depending on what it
is being ranked against: against tracts in Philadelphia vs. tracts in
PA. This is because the distribution of tract-level percentage of
minority is very different for Philadelphia and PA.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="va">cdc_svi_pa_ct_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>GEOID <span class="op">=</span> <span class="va">FIPS</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"EP_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co">#adjunt var</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EP_NOINT"</span>, <span class="st">"EP_AFAM"</span>, <span class="st">"EP_HISP"</span>, <span class="st">"EP_ASIAN"</span>,</span>
<span>    <span class="st">"EP_AIAN"</span>, <span class="st">"EP_NHPI"</span>, <span class="st">"EP_TWOMORE"</span>, <span class="st">"EP_OTHERRA"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="st">"PA"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">mont_ct_svi_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">GEOID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"EP_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="st">"MONTCO"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="va">phl_ct_svi_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">GEOID</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"EP_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>area <span class="op">=</span> <span class="st">"PHL"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">density_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">df2</span>, <span class="va">df3</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">17</span>, names_to <span class="op">=</span> <span class="st">"EP_var"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">density_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">EP_var</span> <span class="op">==</span> <span class="st">"EP_MINRTY"</span>,</span>
<span>    <span class="va">area</span> <span class="op">!=</span> <span class="st">"MONTCO"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">area</span>, fill <span class="op">=</span> <span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>adjust <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Tract-level EP_MINRTY (2020)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Pct. Minority"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Area"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="tract-level_SVI_in_Philly_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>The data distribution within an area can be considered as the
“context” of SVI, and this context matters as many variables turn out to
have different distribution among PA, Philadelphia and Montgomery
County.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">density_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">area</span>, fill <span class="op">=</span> <span class="va">area</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>adjust <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">EP_var</span>, scales <span class="op">=</span> <span class="st">'free'</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Tract-level SVI Variables (2020)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Percent estimate of each variable"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Area"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, hjust <span class="op">=</span> <span class="fl">0</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="tract-level_SVI_in_Philly_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p>Out of the 16 SVI variables, several show variation in data
distribution among the three regions of interest, such as EP_MINRTY,
percentage of persons with no high school diploma (EP_NOHSDP),
percentage of persons below 150% poverty (EP_POV150) and percentage
uninsured in the noninstitutionalized population (EP_UNINSUR). In many
of these cases, the values of SVI variables are concentrated at the
lowest level for Montgomery County and the highest level for
Philadelphia County, with PA in the middle.</p>
<p>In keeping with the pattern, the table below summarizes median values
of the SVI variables in the 4 different themes for the three regions
discussed above: PA, Philadelphia County and Montgomery County.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">var_theme</span> <span class="op">&lt;-</span> <span class="va">variable_e_ep_calculation_2020</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>var <span class="op">=</span> <span class="va">x2020_variable_name</span>, <span class="va">theme</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">var</span>, <span class="st">"EP_"</span><span class="op">)</span>,</span>
<span>    <span class="va">theme</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">density_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">area</span>, <span class="va">EP_var</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>values_from <span class="op">=</span> <span class="va">median</span>, names_from <span class="op">=</span> <span class="va">area</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>var <span class="op">=</span> <span class="va">EP_var</span>, <span class="va">PA</span>, <span class="va">PHL</span>, <span class="va">MONTCO</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">var_theme</span>, by <span class="op">=</span> <span class="st">"var"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">theme</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    theme_name <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html" class="external-link">case_match</a></span><span class="op">(</span></span>
<span>    <span class="va">theme</span>,</span>
<span>    <span class="fl">1</span> <span class="op">~</span> <span class="st">"Socioeconomic Status"</span>,</span>
<span>    <span class="fl">2</span> <span class="op">~</span> <span class="st">"Household Characteristics"</span>,</span>
<span>    <span class="fl">3</span> <span class="op">~</span> <span class="st">"Racial and Ethnic Minority Status"</span>,</span>
<span>    <span class="fl">4</span> <span class="op">~</span> <span class="st">"Housing Type or Transportation"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'area'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 16 × 6</span></span></span>
<span><span class="co">#&gt;    var           PA   PHL MONTCO theme theme_name                       </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> EP_HBURD    23.3 34.9   22.2      1 Socioeconomic Status             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> EP_NOHSDP    7.4 12.0    4.05     1 Socioeconomic Status             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> EP_POV150   16.6 30.8    7.6      1 Socioeconomic Status             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> EP_UNEMP     4.6  7.9    3.9      1 Socioeconomic Status             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> EP_UNINSUR   4.3  6.2    2.5      1 Socioeconomic Status             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> EP_AGE17    20.1 20     21.3      2 Household Characteristics        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> EP_AGE65    18.2 12.6   16.6      2 Household Characteristics        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> EP_DISABL   13.9 15.7    9.4      2 Household Characteristics        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> EP_LIMENG    0.5  1.9    1        2 Household Characteristics        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> EP_SNGPNT    4.6  8.35   3.9      2 Household Characteristics        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> EP_MINRTY   13.7 70     21.0      3 Racial and Ethnic Minority Status</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> EP_CROWD     0.7  2.05   0.6      4 Housing Type or Transportation   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> EP_GROUPQ    0.2  0.4    0.2      4 Housing Type or Transportation   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> EP_MOBILE    0.4  0      0        4 Housing Type or Transportation   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> EP_MUNIT     3.2  7.45   8.6      4 Housing Type or Transportation   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> EP_NOVEH     6.6 28.4    3.9      4 Housing Type or Transportation</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="two-angles-of-a-story">Two angles of a story<a class="anchor" aria-label="anchor" href="#two-angles-of-a-story"></a>
</h2>
<p>While SVI using percentile ranks against all PA tracts offers a broad
perspective into community vulnerability relative to the state, SVI
using ranks against tracts within the county (or region of interest)
focuses on local context, comparing communities to their immediate
surroundings.</p>
<p>When examining the social vulnerability within a smaller region,
especially metropolitan areas/cities, it may be helpful to consider the
context during calculation to better understand the disparities between
different communities.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Heli Xu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
